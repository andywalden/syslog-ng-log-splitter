# syslog-ng-log-splitter

If you ever have a log like this, with essentially a summary of multiple events within a single event:

    <188>2019-11-12 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", ip="112.64.184.29->112.64.185.124; 112.64.249.153->112.64.185.124; 112.64.184.30->118.184.176.57; 202.103.195.130->112.64.185.124; 112.64.185.124->118.184.176.57; 210.22.71.188->118.184.176.57; 124.88.46.138->27.115.63.185; 112.100.87.97->112.64.185.124; 211.136.217.133->112.64.185.124; 121.58.1.197->112.64.185.124; 112.100.87.109->112.64.185.124; 218.31.229.121->112.64.185.124", begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    
that you would like to turn into multiple log lines like these so that each IP pair can be logged as it's own event:

    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 112.64.184.29->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 112.64.249.153->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 112.64.184.30->118.184.176.57 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 202.103.195.130->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 112.64.185.124->118.184.176.57 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 210.22.71.188->118.184.176.57 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 124.88.46.138->27.115.63.185 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 112.100.87.97->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 211.136.217.133->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 121.58.1.197->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 112.100.87.109->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"
    Nov 18 18:25:08 10.10.10.97 03:57:50 AntiDDoS1680 %%01ATK/4/FIREWALLATCK(l):AttackType="Trace route attack", slot=" ", cpu="0", receive interface="GE1/0/8 GE1/0/9 GE1/0/8 GE1/0/9 GE1/0/8 ", proto="ICMP", 218.31.229.121->112.64.185.124 begin time=2019/11/12 11:57:20 , end time=2019/11/12 11:57:50 , total packets="3059", max speed="0", Action="discard"

This is an example syslog-ng.conf and python file to do just that.

